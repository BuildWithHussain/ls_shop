<div class="flex justify-between items-center border-b border-gray-200 pb-4 mt-6">
    <h2 class="text-lg font-semibold text-red-800">
        {{ _('Billing details') }}
    </h2>
    <h3 class="text-sm text-red-800 hover:text-red-900 font-semibold ms-2 cursor-pointer" x-show="!show_billing_state"
        x-cloak @click="show_billing_state = true;
        billing_address_filled = false;
        payment_mode_confirmed = false " x-collapse.duration.300ms x-transition:enter="ease-out duration-200"
        x-transition:leave="ease-in duration-100">
        {{icon(name="edit",classes="h-5 w-5")}}
    </h3>
</div>
<div x-show="show_billing_state" x-ref="billing_form" class="mt-5" x-collapse.duration.300ms
    x-transition:enter="ease-out duration-200" x-transition:leave="ease-in duration-100">
    <div>
        <!-- Billing Address -->
        <h3 class="text-base font-medium">{{ _('Billing Address') }}</h3>
        <div class="mt-2 space-y-3 flex flex-col">
            <label
                class="flex items-center p-3 space-x-3 bg-white border rounded-lg hover:bg-gray-50 border-gray-200/70">
                <input type="radio" name="billing_tab" value="saved_address"
                    class="accent-gray-900 translate-y-px focus:ring-gray-700" x-model="billing_use_address" />
                <span class="text-base capitalize">
                    {{ _('use existing address') }}
                </span>
            </label>
            <label
                class="flex items-center p-3 space-x-3 bg-white border rounded-lg hover:bg-gray-50 border-gray-200/70">
                <input type="radio" name="billing_tab" value="new_address"
                    class="accent-gray-900 translate-y-px focus:ring-gray-700" x-model="billing_use_address" />
                <span class="text-base capitalize">
                    {{ _('add new address') }}
                </span>
            </label>
        </div>
        <!-- Expandable Billing Address Form -->
        <div x-show="billing_use_address === 'new_address'" x-collapse.duration.300ms
            x-transition:enter="ease-out duration-200" x-transition:leave="ease-in duration-100" x-cloak
            class="mt-6 space-y-4 origin-top">
            {{ address_form(id="billing",country_list = country_list) }}
        </div>
        <div x-show="billing_use_address === 'saved_address'" x-collapse.duration.300ms
            x-transition:enter="transform transition ease-out duration-200"
            x-transition:enter-start="opacity-0 scale-y-0" x-transition:enter-end="opacity-100 scale-y-100"
            x-transition:leave="transform transition ease-in duration-100"
            x-transition:leave-start="opacity-100 scale-y-100" x-transition:leave-end="opacity-0 scale-y-0" x-cloak
            class="mt-4">
            <h4 class="text-sm font-medium mb-2 capitalize">{{_('saved addresses')}}</h4>
            <div class="space-y-20">
                {{ search_combo_box.combo_box(options=billing_addresses,id='billing') }}
            </div>
        </div>
        <!-- Checkbox for Same Shipping Address -->
        <div class="mt-6">
            <label class="flex items-center space-x-2">
                <input type="checkbox" name="shipping_address_same_as_billing_address" x-model="same_as_billing"
                    class="accent-red-800 w-4 h-4 rounded-full" checked>
                <span class="text-sm text-gray-600">{{ _('Shipping address same as billing')
                    }}</span>
            </label>
        </div>
        <!-- Shipping Address (Hidden if Checkbox is Checked) -->
        <div x-show="!same_as_billing" x-collapse.duration.300ms x-transition:enter="ease-out duration-200"
            x-transition:leave="ease-in duration-100" x-cloak class="mt-6">
            <h3 class="text-base font-medium">{{ _('Shipping Address') }}</h3>
            <div class="mt-2 space-y-3 flex flex-col">
                <label
                    class="flex items-center p-3 space-x-3 bg-white border rounded-lg hover:bg-gray-50 border-gray-200/70 cursor-pointer shadow-xs">
                    <input type="radio" name="shipping_tab" value="saved_address"
                        class="accent-gray-900 translate-y-px focus:ring-gray-700" x-model="shipping_use_address" />
                    <span class="text-base capitalize">
                        {{ _('use existing address') }}
                    </span>
                </label>
                <label
                    class="flex items-center p-3 space-x-3 bg-white border rounded-lg hover:bg-gray-50 border-gray-200/70 cursor-pointer shadow-xs">
                    <input type="radio" name="shipping_tab" value="new_address"
                        class="accent-gray-900 translate-y-px focus:ring-gray-700" x-model="shipping_use_address" />
                    <span class="text-base capitalize">
                        {{ _('add new address') }}
                    </span>
                </label>
            </div>
            <!-- Expandable Shipping Address Form -->
            <div x-show="shipping_use_address === 'new_address'" x-collapse.duration.300ms
                x-transition:enter="ease-out duration-200" x-transition:leave="ease-in duration-100" x-cloak
                class="mt-6 space-y-4 origin-top">
                {{ address_form(id="shipping",country_list=country_list) }}
            </div>
            <div x-show="shipping_use_address === 'saved_address'" x-collapse.duration.300ms
                x-transition:enter="transform transition ease-out duration-200"
                x-transition:enter-start="opacity-0 scale-y-0" x-transition:enter-end="opacity-100 scale-y-100"
                x-transition:leave="transform transition ease-in duration-100"
                x-transition:leave-start="opacity-100 scale-y-100" x-transition:leave-end="opacity-0 scale-y-0" x-cloak
                class="mt-4">
                <h4 class="text-sm font-medium mb-2 capitalize">{{_('saved addresses')}}</h4>
                <div class="space-y-2">
                    {{ search_combo_box.combo_box(options=shipping_addresses,id='shipping') }}
                </div>
            </div>
        </div>
    </div>
</div>